<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡πÅ‡∏ä‡∏£‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏î‡πâ‡∏ß‡∏¢ Web Share API</title>
</head>
<body style="font-family: sans-serif; text-align: center; margin-top: 50px;">
  <h2>‡πÅ‡∏ä‡∏£‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÑ‡∏õ Facebook ‡∏´‡∏£‡∏∑‡∏≠ Story</h2>

  <button id="share-btn" style="padding: 10px 20px; font-size: 16px;">
    üì§ ‡πÅ‡∏ä‡∏£‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û 3
  </button>

  <script>
    async function shareImage(imageUrl, imageBlob) {
      try {
        // ‚úÖ ‡∏ñ‡πâ‡∏≤ browser ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Web Share API + file sharing
        if (navigator.canShare && navigator.canShare({ files: [new File([imageBlob], 'image.jpg', { type: 'image/jpeg' })] })) {
          await navigator.share({
            files: [new File([imageBlob], 'image.jpg', { type: 'image/jpeg' })],
            title: 'Share to Facebook Story',
            text: '‡πÅ‡∏ä‡∏£‡πå‡∏†‡∏≤‡∏û‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Facebook Story üì∏',
          });
          console.log('‡πÅ‡∏ä‡∏£‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        } else if (navigator.share) {
          // ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö share ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå (‡πÄ‡∏ä‡πà‡∏ô iOS Safari ‡πÄ‡∏Å‡πà‡∏≤)
          await navigator.share({
            url: imageUrl,
            title: 'Share to Facebook Story',
            text: '‡πÅ‡∏ä‡∏£‡πå‡∏†‡∏≤‡∏û‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Facebook üì∏',
          });
        } else {
          // ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ Web Share API ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå Facebook ‡πÅ‡∏ó‡∏ô
          window.open(
            `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(imageUrl)}`,
            '_blank'
          );
        }
      } catch (error) {
        console.log('‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:', error);
      }
    }

    document.getElementById('share-btn').addEventListener('click', async () => {
      const imageUrl = 'https://storage.googleapis.com/hah-staging-bucket/line/0a88888c-123f-471a-a1e7-41e78704603d.jpeg';
      const res = await fetch(imageUrl);
      const blob = await res.blob();

      await shareImage(imageUrl, blob);
    });
  </script>
</body>
</html>
